<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Jetter | Scan</title>
  <link rel="stylesheet" type="text/css" href="./css/style.css">
</head>
<body>
  <nav>
    <a class="nav-link" href="https://www.directalloys.com/DANews.aspx">News</a>
  </nav>
  <section>
    <img src="https://www.directalloys.com/images/logoleft.gif" />
    <img src="https://www.directalloys.com/images/logoright.gif" />
  </section>
  <div class="sub-heading">
    <h3>Industry News</h3>
    <p>A compiled list of recent press releases and news is shown below.<br>Use the filters to find specific articles.</p>
  </div>

  <div id="companies">
    <button onclick="scanAll()">Run Scan</button>
  </div>

  <div id="articles">

  </div>

  <script>
    let articleData = [];

    async function scanOne() {
      const res = await fetch('https://jetscan-fcaf0aedc4e1.herokuapp.com/scan');
      let jsoned = await res.json();

      console.log(articleData)
      renderArticles(articleData);
    }

    async function scanAll() {
      console.log('scanning');
      const res = await fetch('https://jetscan-fcaf0aedc4e1.herokuapp.com/scan-all');
      let jsoned = await res.json();
      articleData = jsoned.entries;
      console.log(articleData)
      renderArticles(articleData);
    }

    function renderArticles(data = articleData) {
      const container = document.getElementById('articles');
      container.innerHTML = '';

      data.forEach(group => {
        const { company, source, articles } = group;

        const groupDiv = document.createElement('div');
        groupDiv.className = 'company-group';

        const title = document.createElement('div');
        title.className = 'company-title';
        title.textContent = company;
        groupDiv.appendChild(title);

        articles.forEach(article => {
          
        })

        container.appendChild(groupDiv);


      })
    }
  </script>
</body>
</html>
